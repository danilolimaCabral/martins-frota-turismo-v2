{
  "query": "-- Tabela de templates de check-list (modelos por tipo de veículo)\nCREATE TABLE IF NOT EXISTS checklist_templates (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  nome VARCHAR(255) NOT NULL,\n  tipo_veiculo ENUM('onibus', 'van', 'carro', 'micro-onibus') NOT NULL,\n  descricao TEXT,\n  ativo BOOLEAN DEFAULT TRUE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Tabela de itens do check-list\nCREATE TABLE IF NOT EXISTS checklist_itens (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  template_id INT NOT NULL,\n  categoria ENUM('Pneus', 'Luzes', 'Freios', 'Motor', 'Documentos', 'Limpeza', 'Seguranca', 'Outros') NOT NULL,\n  descricao VARCHAR(255) NOT NULL,\n  obrigatorio BOOLEAN DEFAULT TRUE,\n  ordem INT DEFAULT 0,\n  FOREIGN KEY (template_id) REFERENCES checklist_templates(id) ON DELETE CASCADE\n);\n\n-- Tabela de check-lists realizados\nCREATE TABLE IF NOT EXISTS checklists (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  veiculo_id INT NOT NULL,\n  motorista_id INT NOT NULL,\n  template_id INT NOT NULL,\n  data_realizacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  km_atual INT,\n  status ENUM('em_andamento', 'concluido', 'com_problemas') DEFAULT 'em_andamento',\n  observacoes TEXT,\n  FOREIGN KEY (veiculo_id) REFERENCES vehicles(id),\n  FOREIGN KEY (motorista_id) REFERENCES drivers(id),\n  FOREIGN KEY (template_id) REFERENCES checklist_templates(id)\n);\n\n-- Tabela de respostas do check-list\nCREATE TABLE IF NOT EXISTS checklist_respostas (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  checklist_id INT NOT NULL,\n  item_id INT NOT NULL,\n  resposta ENUM('ok', 'problema', 'nao_aplicavel') NOT NULL,\n  observacao TEXT,\n  foto_url VARCHAR(500),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (checklist_id) REFERENCES checklists(id) ON DELETE CASCADE,\n  FOREIGN KEY (item_id) REFERENCES checklist_itens(id)\n);\n\n-- Tabela de ordens de serviço (OS)\nCREATE TABLE IF NOT EXISTS ordens_servico (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  veiculo_id INT NOT NULL,\n  checklist_id INT,\n  tipo ENUM('preventiva', 'corretiva', 'emergencial') DEFAULT 'corretiva',\n  prioridade ENUM('baixa', 'media', 'alta', 'urgente') DEFAULT 'media',\n  status ENUM('pendente', 'em_andamento', 'aguardando_pecas', 'finalizada', 'cancelada') DEFAULT 'pendente',\n  descricao_problema TEXT NOT NULL,\n  mecanico_responsavel VARCHAR(255),\n  data_abertura TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  data_inicio TIMESTAMP NULL,\n  data_conclusao TIMESTAMP NULL,\n  km_veiculo INT,\n  custo_total DECIMAL(10,2) DEFAULT 0,\n  observacoes TEXT,\n  FOREIGN KEY (veiculo_id) REFERENCES vehicles(id),\n  FOREIGN KEY (checklist_id) REFERENCES checklists(id)\n);\n\n-- Tabela de itens/serviços da OS\nCREATE TABLE IF NOT EXISTS os_itens (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  os_id INT NOT NULL,\n  tipo ENUM('peca', 'servico', 'mao_de_obra') NOT NULL,\n  descricao VARCHAR(255) NOT NULL,\n  quantidade DECIMAL(10,2) DEFAULT 1,\n  valor_unitario DECIMAL(10,2) NOT NULL,\n  valor_total DECIMAL(10,2) NOT NULL,\n  fornecedor VARCHAR(255),\n  nota_fiscal VARCHAR(100),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (os_id) REFERENCES ordens_servico(id) ON DELETE CASCADE\n);\n\n-- Tabela de peças (estoque)\nCREATE TABLE IF NOT EXISTS pecas (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  codigo VARCHAR(50) UNIQUE,\n  nome VARCHAR(255) NOT NULL,\n  descricao TEXT,\n  categoria VARCHAR(100),\n  unidade ENUM('UN', 'PC', 'KG', 'L', 'M', 'CX') DEFAULT 'UN',\n  estoque_atual INT DEFAULT 0,\n  estoque_minimo INT DEFAULT 0,\n  preco_medio DECIMAL(10,2) DEFAULT 0,\n  localizacao VARCHAR(100),\n  ativo BOOLEAN DEFAULT TRUE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Tabela de fornecedores de peças\nCREATE TABLE IF NOT EXISTS fornecedores_pecas (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  nome VARCHAR(255) NOT NULL,\n  cnpj VARCHAR(18),\n  telefone VARCHAR(20),\n  email VARCHAR(255),\n  endereco TEXT,\n  contato_responsavel VARCHAR(255),\n  observacoes TEXT,\n  ativo BOOLEAN DEFAULT TRUE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Tabela de custos agregados por veículo (para relatórios rápidos)\nCREATE TABLE IF NOT EXISTS custos_veiculo (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  veiculo_id INT NOT NULL,\n  mes INT NOT NULL,\n  ano INT NOT NULL,\n  total_manutencoes DECIMAL(10,2) DEFAULT 0,\n  total_pecas DECIMAL(10,2) DEFAULT 0,\n  total_mao_obra DECIMAL(10,2) DEFAULT 0,\n  quantidade_os INT DEFAULT 0,\n  km_rodado INT DEFAULT 0,\n  custo_por_km DECIMAL(10,4) DEFAULT 0,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (veiculo_id) REFERENCES vehicles(id),\n  UNIQUE KEY unique_veiculo_mes_ano (veiculo_id, mes, ano)\n);\n\n-- Tabela de contas a pagar (integração financeira)\nCREATE TABLE IF NOT EXISTS contas_pagar (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  os_id INT,\n  tipo ENUM('manutencao', 'combustivel', 'seguro', 'licenciamento', 'outros') DEFAULT 'manutencao',\n  descricao VARCHAR(255) NOT NULL,\n  fornecedor VARCHAR(255),\n  valor DECIMAL(10,2) NOT NULL,\n  data_vencimento DATE NOT NULL,\n  data_pagamento DATE NULL,\n  status ENUM('pendente', 'pago', 'atrasado', 'cancelado') DEFAULT 'pendente',\n  forma_pagamento ENUM('dinheiro', 'pix', 'boleto', 'cartao', 'transferencia'),\n  nota_fiscal VARCHAR(100),\n  observacoes TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (os_id) REFERENCES ordens_servico(id)\n);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 4GH8MCSqhpmNowN.efeda4e2cea8 --database fsPfZDk4yqhxEkCbsNC9Vh --execute -- Tabela de templates de check-list (modelos por tipo de veículo)\nCREATE TABLE IF NOT EXISTS checklist_templates (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  nome VARCHAR(255) NOT NULL,\n  tipo_veiculo ENUM('onibus', 'van', 'carro', 'micro-onibus') NOT NULL,\n  descricao TEXT,\n  ativo BOOLEAN DEFAULT TRUE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Tabela de itens do check-list\nCREATE TABLE IF NOT EXISTS checklist_itens (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  template_id INT NOT NULL,\n  categoria ENUM('Pneus', 'Luzes', 'Freios', 'Motor', 'Documentos', 'Limpeza', 'Seguranca', 'Outros') NOT NULL,\n  descricao VARCHAR(255) NOT NULL,\n  obrigatorio BOOLEAN DEFAULT TRUE,\n  ordem INT DEFAULT 0,\n  FOREIGN KEY (template_id) REFERENCES checklist_templates(id) ON DELETE CASCADE\n);\n\n-- Tabela de check-lists realizados\nCREATE TABLE IF NOT EXISTS checklists (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  veiculo_id INT NOT NULL,\n  motorista_id INT NOT NULL,\n  template_id INT NOT NULL,\n  data_realizacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  km_atual INT,\n  status ENUM('em_andamento', 'concluido', 'com_problemas') DEFAULT 'em_andamento',\n  observacoes TEXT,\n  FOREIGN KEY (veiculo_id) REFERENCES vehicles(id),\n  FOREIGN KEY (motorista_id) REFERENCES drivers(id),\n  FOREIGN KEY (template_id) REFERENCES checklist_templates(id)\n);\n\n-- Tabela de respostas do check-list\nCREATE TABLE IF NOT EXISTS checklist_respostas (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  checklist_id INT NOT NULL,\n  item_id INT NOT NULL,\n  resposta ENUM('ok', 'problema', 'nao_aplicavel') NOT NULL,\n  observacao TEXT,\n  foto_url VARCHAR(500),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (checklist_id) REFERENCES checklists(id) ON DELETE CASCADE,\n  FOREIGN KEY (item_id) REFERENCES checklist_itens(id)\n);\n\n-- Tabela de ordens de serviço (OS)\nCREATE TABLE IF NOT EXISTS ordens_servico (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  veiculo_id INT NOT NULL,\n  checklist_id INT,\n  tipo ENUM('preventiva', 'corretiva', 'emergencial') DEFAULT 'corretiva',\n  prioridade ENUM('baixa', 'media', 'alta', 'urgente') DEFAULT 'media',\n  status ENUM('pendente', 'em_andamento', 'aguardando_pecas', 'finalizada', 'cancelada') DEFAULT 'pendente',\n  descricao_problema TEXT NOT NULL,\n  mecanico_responsavel VARCHAR(255),\n  data_abertura TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  data_inicio TIMESTAMP NULL,\n  data_conclusao TIMESTAMP NULL,\n  km_veiculo INT,\n  custo_total DECIMAL(10,2) DEFAULT 0,\n  observacoes TEXT,\n  FOREIGN KEY (veiculo_id) REFERENCES vehicles(id),\n  FOREIGN KEY (checklist_id) REFERENCES checklists(id)\n);\n\n-- Tabela de itens/serviços da OS\nCREATE TABLE IF NOT EXISTS os_itens (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  os_id INT NOT NULL,\n  tipo ENUM('peca', 'servico', 'mao_de_obra') NOT NULL,\n  descricao VARCHAR(255) NOT NULL,\n  quantidade DECIMAL(10,2) DEFAULT 1,\n  valor_unitario DECIMAL(10,2) NOT NULL,\n  valor_total DECIMAL(10,2) NOT NULL,\n  fornecedor VARCHAR(255),\n  nota_fiscal VARCHAR(100),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (os_id) REFERENCES ordens_servico(id) ON DELETE CASCADE\n);\n\n-- Tabela de peças (estoque)\nCREATE TABLE IF NOT EXISTS pecas (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  codigo VARCHAR(50) UNIQUE,\n  nome VARCHAR(255) NOT NULL,\n  descricao TEXT,\n  categoria VARCHAR(100),\n  unidade ENUM('UN', 'PC', 'KG', 'L', 'M', 'CX') DEFAULT 'UN',\n  estoque_atual INT DEFAULT 0,\n  estoque_minimo INT DEFAULT 0,\n  preco_medio DECIMAL(10,2) DEFAULT 0,\n  localizacao VARCHAR(100),\n  ativo BOOLEAN DEFAULT TRUE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Tabela de fornecedores de peças\nCREATE TABLE IF NOT EXISTS fornecedores_pecas (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  nome VARCHAR(255) NOT NULL,\n  cnpj VARCHAR(18),\n  telefone VARCHAR(20),\n  email VARCHAR(255),\n  endereco TEXT,\n  contato_responsavel VARCHAR(255),\n  observacoes TEXT,\n  ativo BOOLEAN DEFAULT TRUE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Tabela de custos agregados por veículo (para relatórios rápidos)\nCREATE TABLE IF NOT EXISTS custos_veiculo (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  veiculo_id INT NOT NULL,\n  mes INT NOT NULL,\n  ano INT NOT NULL,\n  total_manutencoes DECIMAL(10,2) DEFAULT 0,\n  total_pecas DECIMAL(10,2) DEFAULT 0,\n  total_mao_obra DECIMAL(10,2) DEFAULT 0,\n  quantidade_os INT DEFAULT 0,\n  km_rodado INT DEFAULT 0,\n  custo_por_km DECIMAL(10,4) DEFAULT 0,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (veiculo_id) REFERENCES vehicles(id),\n  UNIQUE KEY unique_veiculo_mes_ano (veiculo_id, mes, ano)\n);\n\n-- Tabela de contas a pagar (integração financeira)\nCREATE TABLE IF NOT EXISTS contas_pagar (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  os_id INT,\n  tipo ENUM('manutencao', 'combustivel', 'seguro', 'licenciamento', 'outros') DEFAULT 'manutencao',\n  descricao VARCHAR(255) NOT NULL,\n  fornecedor VARCHAR(255),\n  valor DECIMAL(10,2) NOT NULL,\n  data_vencimento DATE NOT NULL,\n  data_pagamento DATE NULL,\n  status ENUM('pendente', 'pago', 'atrasado', 'cancelado') DEFAULT 'pendente',\n  forma_pagamento ENUM('dinheiro', 'pix', 'boleto', 'cartao', 'transferencia'),\n  nota_fiscal VARCHAR(100),\n  observacoes TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (os_id) REFERENCES ordens_servico(id)\n);",
  "returncode": 1,
  "logs": [
    "ERROR 1824 (HY000) at line 23: Failed to open the referenced table 'vehicles'"
  ]
}